<html>
  <head>
    <script src="https://code.createjs.com/createjs-2015.05.21.min.js"></script>
    <script>

      var cc = [{x: 172, y: 136}, {x: 198, y: 136}, {x: 220, y: 136}, {x: 247, y: 136}, {x: 268, y: 137}, {x: 294, y: 138}, {x: 319, y: 138}, {x: 356, y: 139}, {x: 268, y: 146}, {x: 270, y: 168}, {x: 270, y: 190}, {x: 270, y: 218}, {x: 270, y: 247}, {x: 269, y: 277}, {x: 269, y: 306}, {x: 263, y: 335}, {x: 256, y: 359}, {x: 233, y: 365}, {x: 209, y: 360}, {x: 189, y: 334}, {x: 176, y: 313}, {x: 364, y: 248}, {x: 364, y: 273}, {x: 364, y: 300}, {x: 364, y: 318}, {x: 371, y: 349}, {x: 394, y: 371}, {x: 419, y: 374}, {x: 446, y: 365}, {x: 461, y: 346}, {x: 466, y: 317}, {x: 466, y: 286}, {x: 464, y: 246}, {x: 528, y: 236}, {x: 529, y: 257}, {x: 529, y: 293}, {x: 532, y: 319}, {x: 536, y: 346}, {x: 535, y: 375}, {x: 552, y: 250}, {x: 580, y: 231}, {x: 613, y: 235}, {x: 621, y: 253}, {x: 630, y: 280}, {x: 632, y: 309}, {x: 635, y: 338}, {x: 636, y: 361}, {x: 636, y: 375}, {x: 703, y: 223}, {x: 722, y: 245}, {x: 743, y: 267}, {x: 757, y: 286}, {x: 778, y: 306}, {x: 791, y: 327}, {x: 806, y: 351}, {x: 823, y: 375}, {x: 709, y: 387}, {x: 721, y: 364}, {x: 732, y: 340}, {x: 744, y: 312}, {x: 775, y: 268}, {x: 795, y: 247}, {x: 812, y: 223}, {x: 894, y: 146}, {x: 897, y: 216}, {x: 899, y: 238}, {x: 902, y: 261}, {x: 903, y: 284}, {x: 904, y: 310}, {x: 905, y: 338}, {x: 905, y: 363}, {x: 983, y: 206}, {x: 986, y: 230}, {x: 989, y: 263}, {x: 994, y: 289}, {x: 996, y: 319}, {x: 996, y: 350}, {x: 998, y: 375}, {x: 1010, y: 228}, {x: 1036, y: 207}, {x: 1063, y: 202}, {x: 1086, y: 217}, {x: 1094, y: 249}, {x: 1098, y: 276}, {x: 1103, y: 298}, {x: 1103, y: 330}, {x: 1103, y: 353}, {x: 1104, y: 372}, {x: 1202, y: 192}, {x: 1183, y: 216}, {x: 1181, y: 245}, {x: 1182, y: 280}, {x: 1196, y: 309}, {x: 1231, y: 309}, {x: 1264, y: 297}, {x: 1287, y: 272}, {x: 1234, y: 182}, {x: 1278, y: 190}, {x: 1261, y: 185}, {x: 1290, y: 214}, {x: 1295, y: 244}, {x: 1298, y: 291}, {x: 1300, y: 326}, {x: 1304, y: 353}, {x: 1304, y: 386}, {x: 1295, y: 410}, {x: 1264, y: 418}, {x: 1243, y: 422}, {x: 1201, y: 417}, {x: 1176, y: 397}, {x: 1220, y: 421},{x: 89, y: 688}, {x: 94, y: 660}, {x: 109, y: 634}, {x: 121, y: 609}, {x: 137, y: 581}, {x: 150, y: 560}, {x: 168, y: 534}, {x: 188, y: 504}, {x: 206, y: 492}, {x: 226, y: 503}, {x: 238, y: 527}, {x: 246, y: 559}, {x: 257, y: 591}, {x: 263, y: 616}, {x: 275, y: 639}, {x: 283, y: 669}, {x: 292, y: 692}, {x: 135, y: 610}, {x: 166, y: 610}, {x: 196, y: 610}, {x: 231, y: 610}, {x: 344, y: 481}, {x: 349, y: 504}, {x: 361, y: 529}, {x: 369, y: 561}, {x: 377, y: 586}, {x: 386, y: 610}, {x: 398, y: 631}, {x: 410, y: 658}, {x: 420, y: 682}, {x: 424, y: 694}, {x: 441, y: 667}, {x: 457, y: 632}, {x: 469, y: 594}, {x: 469, y: 558}, {x: 471, y: 527}, {x: 478, y: 501}, {x: 484, y: 477}, {x: 495, y: 500}, {x: 504, y: 522}, {x: 511, y: 552}, {x: 520, y: 589}, {x: 530, y: 621}, {x: 532, y: 631}, {x: 542, y: 651}, {x: 554, y: 675}, {x: 570, y: 697}, {x: 586, y: 666}, {x: 591, y: 640}, {x: 596, y: 610}, {x: 598, y: 578}, {x: 598, y: 544}, {x: 598, y: 513}, {x: 598, y: 483}, {x: 657, y: 470}, {x: 686, y: 467}, {x: 713, y: 467}, {x: 743, y: 468}, {x: 766, y: 468}, {x: 781, y: 468}, {x: 645, y: 481}, {x: 645, y: 505}, {x: 648, y: 542}, {x: 651, y: 564}, {x: 658, y: 588}, {x: 658, y: 616}, {x: 659, y: 641}, {x: 659, y: 667}, {x: 667, y: 691}, {x: 690, y: 703}, {x: 719, y: 702}, {x: 750, y: 697}, {x: 783, y: 695}, {x: 675, y: 583}, {x: 705, y: 582}, {x: 734, y: 579}, {x: 762, y: 578}, {x: 925, y: 466}, {x: 898, y: 451}, {x: 869, y: 451}, {x: 845, y: 463}, {x: 827, y: 483}, {x: 825, y: 509}, {x: 833, y: 540}, {x: 850, y: 554}, {x: 872, y: 556}, {x: 911, y: 558}, {x: 927, y: 576}, {x: 943, y: 602}, {x: 943, y: 635}, {x: 945, y: 663}, {x: 926, y: 680}, {x: 889, y: 688}, {x: 859, y: 686}, {x: 836, y: 668}, {x: 1017, y: 465}, {x: 1000, y: 482}, {x: 990, y: 512}, {x: 987, y: 537}, {x: 987, y: 572}, {x: 995, y: 606}, {x: 1001, y: 629}, {x: 1011, y: 661}, {x: 1030, y: 674}, {x: 1055, y: 680}, {x: 1082, y: 667}, {x: 1092, y: 640}, {x: 1094, y: 606}, {x: 1093, y: 572}, {x: 1091, y: 542}, {x: 1083, y: 504}, {x: 1069, y: 465}, {x: 1043, y: 461}, {x: 1133, y: 676}, {x: 1138, y: 639}, {x: 1141, y: 611}, {x: 1141, y: 578}, {x: 1141, y: 544}, {x: 1141, y: 507}, {x: 1145, y: 477}, {x: 1155, y: 445}, {x: 1174, y: 484}, {x: 1174, y: 518}, {x: 1184, y: 554}, {x: 1196, y: 582}, {x: 1197, y: 614}, {x: 1205, y: 644}, {x: 1208, y: 668}, {x: 1212, y: 566}, {x: 1212, y: 510}, {x: 1216, y: 539}, {x: 1224, y: 496}, {x: 1224, y: 467}, {x: 1233, y: 445}, {x: 1250, y: 483}, {x: 1253, y: 516}, {x: 1259, y: 550}, {x: 1266, y: 577}, {x: 1276, y: 600}, {x: 1276, y: 634}, {x: 1282, y: 661}, {x: 1326, y: 444}, {x: 1352, y: 441}, {x: 1383, y: 445}, {x: 1301, y: 456}, {x: 1304, y: 480}, {x: 1304, y: 523}, {x: 1306, y: 552}, {x: 1315, y: 576}, {x: 1317, y: 614}, {x: 1324, y: 646}, {x: 1329, y: 669}, {x: 1362, y: 669}, {x: 1385, y: 669}, {x: 1337, y: 570}, {x: 1365, y: 567}, {x: 1387, y: 554}];

      var state, c = [], speed = 0, able = 1, flag = false;
      var KEYCODE_LEFT = 37, 
        KEYCODE_RIGHT = 39,
        KEYCODE_UP = 38, 
        KEYCODE_DOWN = 40,
        KEYCODE_ENTER = 13,
        KEYCODE_W = 87,
        KEYCODE_P = 80,
        KEYCODE_SPACE = 32;
        counts = 1000;

      function init() {
        
        stage = new createjs.Stage("demoCanvas");
        for (var i = 0; i < 111; i++) {
          var circle = new createjs.Shape();
          circle.graphics.beginFill("DeepSkyBlue").drawCircle(0, 0, 20);
          circle.x = 200;
          circle.y = 200;
          stage.addChild(circle);
          c[i] = circle;
        }
        stage.update();
        createjs.Ticker.addEventListener("tick", handleTick);
        stage.addEventListener("stagemousedown", function (evt) {
          var circle = new createjs.Shape();
          circle.graphics.beginFill("DeepSkyBlue").drawCircle(0, 0, 20);
          circle.x = stage.mouseX;
          circle.y = stage.mouseY;
          stage.addChild(circle);
          c.push(circle); 
        });
        document.onkeydown = keyPressed;
      }

      function keyPressed(event) {

        var x = 0, y = 0;
        switch(event.keyCode) {
          case KEYCODE_LEFT:  
            x -= 5;
            break;
          case KEYCODE_RIGHT: 
            x += 5; 
            break;
          case KEYCODE_UP: 
            y -= 5;
            break;
          case KEYCODE_DOWN: 
            y += 5;
            break;
          case KEYCODE_P:
            able = 1-able;
            break;
          case KEYCODE_SPACE:
            flag = !flag;
            break;
          case KEYCODE_W:
            for (var i in c)
              stage.removeChild(c[i]);
            c = [];
            break;
          case KEYCODE_ENTER: 
            var t = "[";
            for (var i in c)
              t += "{x: "+(c[i].x|0)+", y: "+(c[i].y|0)+"}, ";
            document.getElementById("demo").innerHTML = t;
            break;  

        }
        for (var i in c) {
          var circle = c[i];
          circle.x = make(circle.x+x, 0, 1400);
          circle.y = make(circle.y+y, 0, 720);
        }
        stage.update();
      }

      function make(x, low, high) {

        if (x<low)
          return low;
        if (x>high)
          return high;
        return x;
      }

      function handleTick(event) {

        counts--;
        if (counts<0) {
          flag = true;
          counts = 10000000;
        }
        speed = make(speed+Math.random()*2-1, 1, 20)*able;
        for (var i in c) {
          var circle = c[i];
          circle.x = make(circle.x+Math.random()*speed*2-speed, 0, 1400);
          circle.y = make(circle.y+Math.random()*speed*2-speed, 0, 720);
        }
        if (flag)
          merge();
        if (c.length>120)
          document.getElementById("demo3").innerHTML = c.length + "/300";
        if (c.length>300)
          document.getElementById("demo2").innerHTML = "This is the real game.";
        stage.update(event); 
      }

      function merge() {
        for (var i in c) {
          var circle = c[i];
          circle.x = make(circle.x+(Number(c[i].x<cc[i % cc.length].x)+Math.random())*2-2, 0, 1400);
          circle.y = make(circle.y+(Number(c[i].y<cc[i % cc.length].y)+Math.random())*2-2, 0, 720);
        }
      }

    </script>
  </head>
  <body onload="init();">
    <canvas id="demoCanvas" width="1400" height="720"></canvas>
    <p id="demo"></p>
    <span id = "demo3" style="color: #FFF">Try to click the screen above! Another surprise will appears when you complete the word.</span>
    <span style="color: #FFF">Try to click the screen above! Another surprise will appears when you complete the word.</span>
    <a id = "demo2" href="game/aote.html" title="Fun_second"></a>
  </body>
</html>

